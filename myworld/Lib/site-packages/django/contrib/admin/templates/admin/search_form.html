{% load i18n static %}
{% if cl.search_fields %}
<div id="toolbar">

<form id="changelist-search" method="get" role="search">
    <div><!-- DIV needed for valid HTML -->
        <label for="{{ field }}_searchbar"><img src="{% static "admin/img/search.svg" %}" alt="Search"></label>
        {% for field in cl.search_fields %}
            <input type="text" size="20" name="{{ field }}__icontains" value="{{ request.GET|default:'' }}" id="{{ field }}_searchbar" placeholder="{% trans 'Search by' %} {{ field|capfirst }}">
        {% endfor %}

        <input type="submit" value="{% translate 'Search' %}" class="search-button">
        <input type="button" value="Đặt lại" class="clear-results-button" onclick="clearSearchResults()" style="color:white;height: 26px;font-size:13px">
    </div>

<!-- ---------het custom code ----------  -->
{% if cl.search_help_text %}
<br class="clear">
<div class="help" id="searchbar_helptext">{{ cl.search_help_text }}</div>
{% endif %}
</form></div>
<script>
    function getParameterValue(parameterName) {
        const urlSearchParams = new URLSearchParams(window.location.search);
        return urlSearchParams.get(parameterName);
    }

    // Lấy giá trị của tham số từ URL
    {% for field in cl.search_fields %}
        var original{{ field|title }}Value = getParameterValue('{{ field }}__icontains');
    {% endfor %}
    // Gọi hàm restoreSearchValues khi trang load
    restoreSearchValues();

    function restoreSearchValues() {
        {% for field in cl.search_fields %}
            // Set giá trị từ biến original
            document.getElementById('{{ field }}_searchbar').value = original{{ field|title }}Value;
        {% endfor %}
    }
    function clearSearchResults() {
        // Đặt giá trị trống cho ô tìm kiếm và gửi form
        {% for field in cl.search_fields %}
            document.getElementById('{{ field }}_searchbar').value = '';
        {% endfor %}
        document.getElementById('changelist-search').submit();
    }
</script>
{% endif %}
